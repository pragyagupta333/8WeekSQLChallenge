SET search_path = foodie_fi;

SELECT * FROM PLANS
SELECT * FROM SUBSCRIPTIONS
------------------------------------ A. Customer Journey --------------------------------------------------
/* Based off the 8 sample customers provided in the sample from the subscriptions table, 
write a brief description about each customerâ€™s onboarding journey.
Try to keep it as short as possible - you may also want to run some sort of join to make your explanations a bit easier! */

-- ANS : 
 -- adding a column to show how long it took them to change, upgrade or cancel their subscription.
-- NULL IN DAYS_SPENT MEANS CURRENTLY USING THAT PLAN

SELECT S.CUSTOMER_ID,P.PLAN_NAME,S.START_DATE,
LEAD(START_DATE) OVER(PARTITION BY CUSTOMER_ID ORDER BY START_DATE) - START_DATE AS DAYS_SPENT
FROM PLANS P
JOIN SUBSCRIPTIONS S ON P.PLAN_ID = S.PLAN_ID 
WHERE CUSTOMER_ID <=8
ORDER BY CUSTOMER_ID

/* 
CUSTOMER 1 STARTED WITH TRIAL ON "2020-08-01" AND MOVED TO BASIC MONTHLY PLAN IN 7 DAYS ON "2020-08-08"
CUSTOMER 2 STARTED WITH TRIAL AND MOVED TO PRO ANNUAL PLAN IN 7 DAYS
CUSTOMER 3 STARTED WITH TRIAL AND MOVED TO BASIC MONTHLY PLAN IN 7 DAYS
CUSTOMER 4 STARTED WITH TRIAL AND MOVED TO BASIC MONTHLY PLAN IN 7 DAYS AND USED BASIC MONTHLY FOR 88 DAYS BEFORE CHURNING (UNSUBSCRIBING)
CUSTOMER 5 STARTED WITH TRIAL AND MOVED TO BASIC MONTHLY PLAN IN 7 DAYS
CUSTOMER 6 STARTED WITH TRIAL AND MOVED TO BASIC MONTHLY PLAN IN 7 DAYS AND USED BASIC MONTHLY FOR 58 DAYS BEFORE CHURNING (UNSUBSCRIBING)
CUSTOMER 7 STARTED WITH TRIAL AND MOVED TO BASIC MONTHLY PLAN IN 7 DAYS AND USED BASIC MONTHLY FOR 100 DAYS AND IS CURRENTLY ON PRO MONTHLY 
CUSTOMER 8 STARTED WITH TRIAL AND MOVED TO BASIC MONTHLY PLAN IN 7 DAYS AND USED BASIC MONTHLY FOR 46 DAYS AND IS CURRENTLY ON PRO MONTHLY 
























































